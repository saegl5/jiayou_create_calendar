<!-- hide dryRun checkbox and update reference ID before deployment -->

<!DOCTYPE html>
<html>
  <head>
    <base target="_top" />
    <style>
      /* Basic styling for the form */
      :root {
        --border: silver;
        --background: Gainsboro;
        --foreground: #f8f8f8;
        --section: darkgrey;
        --description: darkgrey;
      }
      form {
        max-width: 528px;
        margin: 0 auto;
        padding: 15px;
        border: 1px solid var(--border);
        border-radius: 5px;
        background-color: var(--background);
      }
      select,
      input[type="text"],
      input[type="submit"],
      textarea {
        display: block;
        margin-bottom: 0px;
        width: 100%;
        -webkit-box-sizing: border-box;
        box-sizing: border-box; /* compatibility */
      }
      select,
      input,
      textarea,
      div {
        font-family: system-ui;
        font-size: medium;
      }
      h1,
      label,
      input[type="submit"],
      text,
      div[id="section"],
      div[id="issues"] {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue",
          sans-serif;
      }
      text {
        font-size: smaller;
        font-style: italic;
        color: var(--description);
      }
      div[id="section"],
      div[id="dry"],
      div[id="issues"],
      div[id="wait"],
      .mid {
        text-align: center;
      }
      div[id="settings"] {
        text-align: left;
        padding-top: 10px;
        padding-left: 15px;
        padding-right: 15px;
        border: 1px solid var(--border);
        border-radius: 5px;
        background-color: var(--foreground);
      }
      div[id="section"] {
        font-weight: bold;
        font-size: smaller;
        color: var(--section);
      }
      input[type="checkbox"] {
        vertical-align: bottom;
      }
      input[type="submit"] {
        border-color: var(--border);
        border-radius: 5px;
      }
      h1 {
        text-align: center;
      }
      div[id="table"] {
        display: table;
        width: 100%;
      }
      div[id="row"] {
        display: table-row;
      }
      div[id="cell"],
      .mid {
        display: table-cell;
      }
      div[id="issues"] {
        font-size: smaller;
      }
      .reference {
        font-style: normal;
      }
    </style>
  </head>
  <body>
    <h1>Create 加油 ("jiā yóu") Calendar</h1>
    <form id="calendarForm">
      <div id="settings">
        <div id="section">Event Settings</div>
        <br />

        <label for="calendarName">Calendar name:</label>
        <input
          type="text"
          id="calendarName"
          name="calendarName"
          value="JIA YOU"
          required
        />
        <text>Must name it differently from the owner name</text>
        <br /><br />

        <label for="timeZone">Time zone:</label>
        <select id="timeZone" name="timeZone">
          <option value="America/New_York">Eastern</option>
          <option value="America/Chicago">Central</option>
          <option value="America/Denver">Mountain</option>
          <option value="America/Los_Angeles" selected="selected">
            Pacific
          </option>
          <!-- Consult https://www.iana.org/time-zones for time zone IDs of other locations. -->
        </select>
        <!-- preselected for convenience -->
        <br />
        <br />

        <!--still create events on these holidays-->
        <label for="holidayExceptions">List holiday exceptions:</label>
        <textarea
          type="text"
          id="holidayExceptions"
          name="holidayExceptions"
          rows="1"
          placeholder="Optional"
        >
Sep 23 2025, Sep 24 2025, Oct 2 2025, Oct 21 2025, Oct 31 2025, Nov 4 2025, Nov 11 2025, Dec 15 2025, Feb 2 2026, Mar 17 2026, Apr 1 2026, Apr 15 2026, Apr 22 2026, May 5 2026, May 27 2026</textarea
        >
        <!-- prefilled for convenience and clarity -->
        <text>Accepted formats: Dec 31 2024, 12/31/2024, 31 Dec 2024</text
        ><br />
        <text>Comma-separated list of dates</text>
        <!-- Why not accept YYYY/MM/DD ? Because it defaults to Coordinated Universal Time -->
        <br /><br />

        <!--repeat this event once-->
        <!-- <label for="halfDays">List half-days:</label> -->
        <label for="halfDays">List repeated days:</label>
        <textarea
          type="text"
          id="halfDays"
          name="halfDays"
          rows="1"
          placeholder="Optional"
        >
Nov 21 2025, Feb 12 2026, Jun 5 2026</textarea
        >
        <!-- prefilled for convenience and clarity -->
        <text>Accepted formats: Dec 31 2024, 12/31/2024, 31 Dec 2024</text
        ><br />
        <text>Comma-separated list of dates</text>
        <!-- Why not accept YYYY/MM/DD ? Because it defaults to Coordinated Universal Time -->
        <br /><br />

        <!--don't create events on these non-holidays-->
        <label for="extraHolidays">List extra holidays:</label>
        <textarea
          type="text"
          id="extraHolidays"
          name="extraHolidays"
          rows="3"
          placeholder="Optional"
        >
Oct 9 2025, Oct 10 2025, Nov 7 2025, Nov 14 2025, Nov 24 2025, Nov 25 2025, Nov 26 2025, Nov 28 2025, Dec 22 2025, Dec 23 2025, Dec 26 2025, Dec 29 2025, Dec 30 2025, Jan 2 2026, Feb 13 2026, Feb 17 2026, Feb 18 2026, Feb 19 2026, Feb 20 2026, Mar 20 2026, Mar 27 2026, Apr 2 2026, Apr 3 2026, Apr 6 2026, Apr 7 2026, Apr 8 2026, Apr 9 2026, Apr 10 2026, May 22 2026</textarea
        >
        <!-- prefilled for convenience and clarity -->
        <text>Accepted formats: Dec 31 2024, 12/31/2024, 31 Dec 2024</text
        ><br />
        <text>Comma-separated list of dates</text>
        <!-- Why not accept YYYY/MM/DD ? Because it defaults to Coordinated Universal Time -->
        <br /><br />

        <div id="table">
          <div id="row">
            <div id="cell">
              <label for="start">Start date:</label>
            </div>
            <div id="cell" class="mid">&nbsp;&nbsp;-&nbsp;&nbsp;</div>
            <div id="cell">
              <label for="end">End date:</label>
            </div>
          </div>
          <div id="row">
            <div id="cell">
              <div class="input-field">
                <input id="start" type="text" class="validate" placeholder="Required" required/>
              </div>
            </div>
            <div id="cell" class="mid">
              <!-- empty -->
            </div>
            <div id="cell">
              <div class="input-field">
                <input id="end" type="text" class="validate" placeholder="Required" required/>
              </div>
            </div>
          </div>
        </div>
        <!-- preselected for convenience -->
        <!-- If startMonth > endMonth, then the calendar will roll over to the new year -->
        <!-- <br /> -->
        <text>Accepted formats: Dec 31 2024, 12/31/2024, 31 Dec 2024</text>
        <br /><br />
      </div>

      <br />

      <div id="dry">
        <input type="checkbox" id="dryRun" name="dryRun" unchecked />
        <label for="dryRun">Dry run</label>
        <!-- test script before running it in production, hide for production by commenting or removing these lines of code -->
      </div>

      <br />

      <input type="submit" value="Submit" />
      <div id="wait">&nbsp;</div>
      <!-- id="wait" div displays function return messages -->
    </form>

    <div id="issues">
      Technical difficulties? Search issues or open a new one on
      <a href="https://github.com/saegl5/jiayou_create_calendar/issues"
        >GitHub</a
      >.

      <br />

      <text class="reference"
        >Reference ID: 358b6e2b5d2e7cefe8d45d91aac4585ad4066d08</text
      >
      <!-- Latest commit SHA from main branch that includes major updates, minor updates, or bug fixes -->
    </div>

    <script>
      // JavaScript handles form submission and sends data to the Google Apps Script
      document
        .getElementById("calendarForm")
        .addEventListener("submit", function (event) {
          event.preventDefault(); // Prevents the form from submitting the traditional way

          var calendarName = document.getElementById("calendarName").value;
          var timeZone = document.getElementById("timeZone").value;
          var holidayExceptions =
            document.getElementById("holidayExceptions").value;
          var halfDays = document.getElementById("halfDays").value;
          var extraHolidays = document.getElementById("extraHolidays").value;
          // var startMonth = document.getElementById("startMonth").value;
          // var endMonth = document.getElementById("endMonth").value;
          var start = document.getElementById("start").value;
          var end = document.getElementById("end").value;

          var dryRun = document.getElementById("dryRun").checked; // by default, checkbox is unchecked, meaning .checked is false

          document.getElementById("wait").innerHTML = "Please wait...";

          google.script.run
            .withSuccessHandler(function (response) {
              document.getElementById("wait").innerHTML = response; // Displays a success message when completed
            })
            .createCalendar(
              calendarName,
              timeZone,
              holidayExceptions,
              halfDays,
              extraHolidays,
              // startMonth,
              // endMonth,
              start,
              end,
              dryRun
            );
        });
    </script>
  </body>
</html>